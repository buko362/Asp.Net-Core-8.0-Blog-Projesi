@using EntityLayer.Concrete
@model List<Comment>
@{
    ViewData["Title"] = "Index";
    Layout = "~/Views/Shared/AdminLayout.cshtml";
}
@* <td><a href="#"><i class="fa fa-check text-navy"></i></a></td> *@
<!DOCTYPE html>
<html>
<body>
    <div class="wrapper wrapper-content animated fadeInRight">
        <div class="row">
            <div class="col-lg-12">
                <div class="ibox ">
                    <div class="ibox-title">
                        @if (TempData["CommentMsg"] != null)
                        {
                            <div class="alert alert-success">@TempData["CommentMsg"]</div>
                        }
                        <h5>Yorumlar  </h5>
                    </div>
                    <div class="ibox-content">
                        <table class="table table-hover">
                            <thead>
                                <tr>
                                    <th>#</th>
                                    <th>Kullanıcı</th>
                                    <th>Yorum</th>
                                    <th>Blog</th>
                                    <th>Puan</th>
                                    <th>Tarih</th>
                                    <th>Sil</th>
                                    <th>Yoruma Git</th>
                                </tr>
                            </thead>
                            <tbody>
                                @foreach (var item in Model)
                                {
                                    <tr>
                                        <th>@item.CommentID</th>
                                        <td>@item.CommentUserName</td>
                                        <td>
                                            @{
                                                var text = (item.CommentContent ?? "").Trim();
                                                var snippet = text.Length > 30 ? text.Substring(0, 30) + "..." : text;
                                            }
                                            @snippet
                                        </td>
                                        <td>@item.Blog.BlogTitle</td>
                                        <td>
                                            @{
                                                int score = item.BlogScore;
                                            }
                                            @if (score <= 0)
                                            {
                                                <span class="text-muted">Puan Yok</span>
                                            }
                                            else
                                            {
                                                for (int i = 1; i <= 5; i++)
                                                {
                                                    if (i <= score)
                                                    {
                                                        <span>★</span>
                                                    }
                                                    else
                                                    {
                                                        <span>☆</span>
                                                    }

                                                }
                                            }


                                            <span class="text-muted">(@score/5)</span>
                                        </td>
                                        <td>@(((DateTime)item.CommentDate).ToString("dd-MMM-yyyy"))</td>

                                        <td>
                                            <form asp-area="Admin" asp-controller="Comment" asp-action="DeleteComment" method="post" style="display:inline;" onsubmit="return confirm('Bu yorumu silmek istediğine emin misin?');">
                                                <input type="hidden" name="id" value="@item.CommentID" />
                                                <button type="submit" class="btn btn-outline-danger">Sil</button>
                                            </form>
                                        </td>

                                        <td><a href="/Blog/BlogReadAll/@item.BlogID" class="btn btn-outline-warning">Yoruma Git</a></td>
                                    </tr>
                                }
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>
    </div>
</body>
</html>
